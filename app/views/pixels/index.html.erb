<h1>Pixels#index</h1>
<p>Find me in app/views/pixels/index.html.erb</p>
<% base_creator_btn.each do |btn|%>
  <%= btn %>
<% end %>
<% unless Pixel.first.nil? %>
    <button class="btn btn-success btn-sm" onClick="cronStateUpdater('enabled')">
        Start Job
    </button>
    <table id="example" class="table table-striped table-bordered" style="width: 1000px;">
        <thead>
            <tr>
                <th>id</th>
                <th>name</th>
                <th>R Gene</th>
                <th>B Gene</th>
                <th>G gene</th>
                <th>parentA</th>
                <th>parentB</th>
            </tr>
        </thead>
        
    </table>
<% end %>

<script type="text/javascript">
    
   var table = $('#example').DataTable(
        {
            "processing": true,
             "order": [[ 0, "desc" ]],
            "ajax": {
                "url": "/pixels/index.json",
                "dataSrc": "data"
            },
            "columns": [
            { "data": "id" },
            { "data": "name", 
                "render": function(data, type, row, meta){
                    console.log(row)
                    if(type === 'display'){
                        data = `<a href="/pixels/${row.id}">  ${data} </a>`;
                    }
                    return data;
                }
             },
            {
                "data": "R"
            },
            {
                "data": "B"
            },
            {
                "data": "G"
            },
            {
                "data": "parentA.name", defaultContent: "Base Pixel"
            },
            {
                "data": "parentB.name", defaultContent: "Base Pixel"
            }
        ]

        }
    );
    document.addEventListener("turbolinks:before-cache", function() {
        if (table !== null) {
        table.destroy();
        table = null;
        }
    });
  $(document).ready(function() {
        setInterval( function () {
            table.ajax.reload();
        }, 660000 );
  });


</script>
